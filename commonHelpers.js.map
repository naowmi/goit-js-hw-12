{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst container = document.querySelector('.gallery');\nconst loaderMore = document.querySelector(\".loader-more-btn\")\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.button-load-more');\nloadMoreBtnHide()\n//? BACK-END PARAMS\nconst API_KEY = \"41813550-341719f2cbf02751aeba3ddbd\";\nlet query = '';\nlet page = 1; \nconst perPage = 40; \n//? BACK-END PARAMS //\n\n//! MODAL\nlet modal = new simpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n//! MODAL //\n\n\n\n//! BACK-END PARAMS \nconst getSearchParams = () =>\n  new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  });\n\naxios.defaults.baseURL = 'https://pixabay.com';\nconst url = `/api/`;\n//! BACK-END PARAMS //\n\n\n//* SUBMIT FORM\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  page = 1; \n  clearContainer()\n  loadMoreBtnHide()\n  query = input.value.trim(); \n\n  if (query === '') return iziToast.info({\n        timeout: 5000,\n        title: \"info\",\n        message:\n          'Sorry, but you need to write at least one character!',\n        position: 'topRight',\n      });; \n  loaderShow()\n  input.value = ''; \n\n  try {\n    const response = await axios.get(url, {\n      params: getSearchParams(),\n    });\n\n    loaderHide()\n    const data = response.data;\n    if (data.hits.length === 0) {\n      iziToast.error({\n        timeout: 5000,\n        title: \"Error\",\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n\n     //? RENDER MARKUP\n    renderMarkup(data.hits)\n\n    if (data.hits.length >= perPage) {\n      loadMoreBtnShow()\n    }\n    modal.refresh();\n  } catch (error) {\n    loader.style.display = 'none';\n    iziToast.error({\n      timeout: 5000,\n      title: \"Error\",\n      message: error.message,\n      position: 'topRight',\n    });\n    console.error('Error when receiving data:', error);\n  }\n});\n//* SUBMIT FORM //\n\n//? LOAD MORE\nloadMoreBtn.addEventListener('click', async () => {\n  loaderMoreShow()\n\n  page += 1;\n\n  try {\n    const response = await axios.get(url, {\n      params: getSearchParams(),\n    });\n\n    loaderMoreHide()\n    const data = response.data;\n\n    if (page >= Math.ceil(data.totalHits / perPage)) {\n      loadMoreBtnHide()\n      iziToast.error({\n        timeout: 5000,\n         title: \"Error\",\n        message: \"You've reached the end of search results\",\n        position: 'topRight'\n      });\n    }\n    //? RENDER MARKUP\n    renderMarkup(data.hits)\n\n    scrollImages();\n\n    modal.refresh();\n  } catch (error) {\n    loaderMoreHide()\n    iziToast.error({\n      timeout: 5000,\n      title: \"Error\",\n      message: error.message,\n      position: \"topRight\",\n    });\n    console.error('Error fetching more data:', error);\n  }\n});\n\nconst scrollImages = () => {\n  const galleryItem = document.querySelector('.gallery-item');\n\n  const galleryItemHeight = galleryItem.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: galleryItemHeight * 3,\n    behavior: 'smooth',\n  });\n};\n\n//? CLEAR CONTAINER\nconst clearContainer = () => {\n  container.innerHTML = \"\";\n}\n\n//! LOADER SHOW AND HIDE\nfunction loaderShow() {\nloader.style.display = 'block';\n}\nfunction loaderHide() {\n  loader.style.display = 'none';\n}\nfunction loaderMoreShow() {\n  loaderMore.style.display = 'block'\n}\nfunction loaderMoreHide() {\n  loaderMore.style.display = \"none\"\n}\n\n\n//! LOAD MORE BUTTON\nfunction loadMoreBtnShow() {\n  loadMoreBtn.style.display = 'block';\n}\nfunction loadMoreBtnHide() {\n  loadMoreBtn.style.display = 'none';\n}\n\n//! RENDER MARKUP\nfunction renderMarkup(data) {\nconst markup = data.reduce(\n      (\n        acc,\n        { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n      ) =>\n        acc +\n        `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n           <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"\n           />\n          </a>         \n          <div class=\"card-container\">\n            <p class=\"p-item\">Likes:<span class=\"span-item\">${likes}</span></p>\n            <p>Views:<span class=\"span-item\">${views}</span></p>\n            <p>Comments:<span class=\"span-item\">${comments}</span></p>\n            <p>Downloads:<span class=\"span-item\">${downloads}</span></p>\n          </div> \n        </li>`,\n      ''\n  );\n  container.insertAdjacentHTML('beforeend', markup);\n}\n    "],"names":["form","input","container","loaderMore","loader","loadMoreBtn","loadMoreBtnHide","API_KEY","query","page","perPage","modal","simpleLightbox","getSearchParams","axios","url","event","clearContainer","iziToast","loaderShow","response","loaderHide","data","renderMarkup","loadMoreBtnShow","error","loaderMoreShow","loaderMoreHide","scrollImages","galleryItemHeight","markup","acc","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}